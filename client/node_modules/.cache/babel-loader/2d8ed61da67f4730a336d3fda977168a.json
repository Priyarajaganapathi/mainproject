{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\nisan\\\\Documents\\\\GitHub\\\\mainproject\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\nisan\\\\Documents\\\\GitHub\\\\mainproject\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\nisan\\\\Documents\\\\GitHub\\\\mainproject\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\nisan\\\\Documents\\\\GitHub\\\\mainproject\\\\client\\\\src\\\\components\\\\mainpages\\\\history\\\\OrderHistory.js\";\nimport React, { useContext, useEffect } from 'react';\nimport { GlobalState } from '../../../GlobalState';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\n\nfunction OrderHistory() {\n  var _this = this;\n\n  var state = useContext(GlobalState);\n\n  var _state$userAPI$histor = _slicedToArray(state.userAPI.history, 2),\n      history = _state$userAPI$histor[0],\n      setHistory = _state$userAPI$histor[1];\n\n  var _state$userAPI$isAdmi = _slicedToArray(state.userAPI.isAdmin, 1),\n      isAdmin = _state$userAPI$isAdmi[0];\n\n  var _state$token = _slicedToArray(state.token, 1),\n      token = _state$token[0];\n\n  useEffect(function () {\n    if (token) {\n      var getHistory = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var res, _res;\n\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!isAdmin) {\n                    _context.next = 7;\n                    break;\n                  }\n\n                  _context.next = 3;\n                  return axios.get('/api/payment', {\n                    headers: {\n                      Authorization: token\n                    }\n                  });\n\n                case 3:\n                  res = _context.sent;\n                  setHistory(res.data);\n                  _context.next = 11;\n                  break;\n\n                case 7:\n                  _context.next = 9;\n                  return axios.get('/user/history', {\n                    headers: {\n                      Authorization: token\n                    }\n                  });\n\n                case 9:\n                  _res = _context.sent;\n                  setHistory(_res.data);\n\n                case 11:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function getHistory() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      getHistory();\n    }\n  }, [token, isAdmin, setHistory]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"history-page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 13\n    }\n  }, \"History\"), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 13\n    }\n  }, \"You have \", history.length, \" ordered\"), /*#__PURE__*/React.createElement(\"table\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 25\n    }\n  }, \"Customer Name\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 25\n    }\n  }, \"Payment ID\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 25\n    }\n  }, \"Date of Purchased\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 17\n    }\n  }, history.map(function (items) {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: items._id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 31\n      }\n    }, function () {\n      console.log(items);\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 33\n      }\n    }, items.paymentID), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 33\n      }\n    }, new Date(items.createdAt).toLocaleDateString()), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/history/\".concat(items._id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 37\n      }\n    }, \"View\")));\n  }))));\n}\n\nexport default OrderHistory;","map":{"version":3,"sources":["C:/Users/nisan/Documents/GitHub/mainproject/client/src/components/mainpages/history/OrderHistory.js"],"names":["React","useContext","useEffect","GlobalState","Link","axios","OrderHistory","state","userAPI","history","setHistory","isAdmin","token","getHistory","get","headers","Authorization","res","data","length","map","items","_id","console","log","paymentID","Date","createdAt","toLocaleDateString"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect} from 'react'\r\nimport {GlobalState} from '../../../GlobalState'\r\nimport {Link} from 'react-router-dom'\r\nimport axios from 'axios'\r\n\r\nfunction OrderHistory() {\r\n    const state = useContext(GlobalState)\r\n    const [history, setHistory] = state.userAPI.history\r\n    const [isAdmin] = state.userAPI.isAdmin\r\n    const [token] = state.token\r\n    \r\n\r\n    useEffect(() => {\r\n        if(token){\r\n            const getHistory = async() =>{\r\n                if(isAdmin){\r\n                    const res = await axios.get('/api/payment', {\r\n                        headers: {Authorization: token}\r\n                    })\r\n                    setHistory(res.data)\r\n                }else{\r\n                    const res = await axios.get('/user/history', {\r\n                        headers: {Authorization: token}\r\n                    })\r\n                    setHistory(res.data)\r\n                }\r\n            }\r\n            getHistory()\r\n        }\r\n    },[token, isAdmin, setHistory])\r\n\r\n    return (\r\n        <div className=\"history-page\">\r\n            <h2>History</h2>\r\n\r\n            <h4>You have {history.length} ordered</h4>\r\n\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th>Customer Name</th>\r\n                        <th>Payment ID</th>\r\n                        <th>Date of Purchased</th>\r\n                        <th></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {\r\n                        history.map(items => (\r\n                              <   tr key={items._id}>\r\n                                {()=>{console.log(items)}}\r\n                                <td>{items.paymentID}</td>\r\n                                <td>{new Date(items.createdAt).toLocaleDateString()}</td>\r\n                                <td><Link to={`/history/${items._id}`}>View</Link></td>\r\n                            </tr>\r\n                            \r\n                        ))\r\n                    }\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default OrderHistory\r\n"]},"metadata":{},"sourceType":"module"}